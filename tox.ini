# Tox configuration for lifelib
# This file helps test the package across multiple Python versions locally
# and ensures consistency with the CI/CD pipeline.

[tox]
envlist = py{37,38,39,310,311,312,313}, lint, coverage
isolated_build = True
skip_missing_interpreters = True

[testenv]
description = Run tests with pytest
deps =
    pytest>=7.0
    pytest-cov>=4.0
    pytest-xdist>=3.0
    pandas
    numpy>=1.16.5
    openpyxl
commands =
    pytest {posargs:-v --cov=lifelib --cov-report=term-missing}

[testenv:lint]
description = Run linting and code quality checks
skip_install = False
deps =
    flake8>=6.0
    black>=23.0
    isort>=5.0
commands =
    flake8 lifelib --count --select=E9,F63,F7,F82 --show-source --statistics
    flake8 lifelib --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
    black --check lifelib
    isort --check-only lifelib

[testenv:coverage]
description = Generate coverage report
deps =
    pytest>=7.0
    pytest-cov>=4.0
    pandas
    numpy>=1.16.5
    openpyxl
commands =
    pytest --cov=lifelib --cov-report=html --cov-report=term --cov-report=xml

[testenv:format]
description = Auto-format code with black and isort
skip_install = True
deps =
    black>=23.0
    isort>=5.0
commands =
    black lifelib
    isort lifelib

[flake8]
exclude = .tox,*.egg,build,data,dist,.git,__pycache__,.eggs
max-line-length = 127
select = E,W,F
ignore = E203,E501,W503
per-file-ignores =
    __init__.py:F401
